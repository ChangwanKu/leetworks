# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text(aes(label=school, y = c(0,100,200,300,400,500,600)), nudge_x = 0.3 )
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text(aes(label=school, y = c(100,200,300,400,500,600)), nudge_x = 0.3 )
from <- fromschool %>% arrange(school) %>% mutate(text_y = cumsum(tot))
from
from <- fromschool %>% arrange(school) %>% mutate(text_y = rev(cumsum(fromschool$tot)))
rev(cumsum(fromschool$tot))
rev(cumsum(fromschool$tot))-fromschool$tot
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text(aes(label=school, y = c(800,700,500,300,200,100)), nudge_x = 0.3 )
rev(cumsum(fromschool$tot))-fromschool$tot
fromschool$tot
cumsum(fromschool$tot))-fromschool$tot
cumsum(fromschool$tot)-fromschool$tot
from <- fromschool %>% arrange(school) %>% mutate(text_y = rev(cumsum(fromschool$tot)-fromschool$tot))
from <- fromschool %>% arrange(school) %>% mutate(text_y = data.frame(rev(cumsum(fromschool$tot)-fromschool$tot)))
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text(aes(label=school, y = c(800,700,500,300,200,100)), nudge_x = 0.7 )
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text_repel(aes(label=school, y = c(800,700,500,300,200,100)), nudge_x = 0.7 )
text_y <- data.frame(pos = rev(cumsum(fromschool$tot)-fromschool$tot/2))
text_y
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text_repel(aes(label=school, y = text_y), nudge_x = 0.7 )
from
selected_data_fromschool <- fromschool_data %>% filter(schoolindex == 3) %>% group_by(school) %>%
mutate(tot = sum(y9, y10, y11, y12, y13, y14, y15, y16, y17)) %>% arrange(desc(tot)) %>% distinct(school,tot)
top5 <- selected_data_fromschool %>%  head(5)
etc <- data.frame(school='기타',tot=sum(selected_data_fromschool$tot)-sum(top5$tot))
fromschool <- bind_rows(top5,etc)
fromschool$school <- factor(fromschool$school, levels = rev(as.character(fromschool$school)))
from <- fromschool %>% arrange(school)
text_y <- data.frame(pos = rev(cumsum(fromschool$tot)-fromschool$tot/2))
from
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
# p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text_repel(aes(label=school, y = text_y), nudge_x = 0.7 )
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text_repel(aes(label=school, y = text_y), nudge_x = 0.7 )
p + geom_text(aes(label=school, y = text_y), nudge_x = 0.7 )
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- p + scale_fill_grey()
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey()
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey()
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.2, end = 0.8)
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.8, end = 0.2)
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
entrance <- read.csv('./rawdatas/application.csv')
ent1 <- entrance %>% filter(schoolindex == 23 & year == 2018) %>% select(3:7) %>% rename()%>% gather()
ent2 <- ent1 %>% filter(value != 0) %>% arrange(desc(value)) %>% mutate(text_y = cumsum(value) - value/2)
ent2$key <- factor(ent2$key,levels = rev(as.character(ent2$key)))
p <- ggplot(ent2,aes(x='',y=value,fill=key)) + geom_bar(width = 1,stat = 'identity', color = 'white')
p <- p + coord_polar(theta = 'y', start = 0 )
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'bottom', legend.title = element_blank()) + guides(fill = guide_legend(reverse = TRUE))
p <- p + geom_text(aes(label = value, y = text_y), nudge_x = .7) + scale_fill_grey(start = 0.8, end = 0.2)
# table plot
p
standard <- read.csv('./rawdatas/entrance_standard.csv')
stan1 <- standard %>% filter(schoolindex == 1 & year == 2018) %>% select(level,leet,gpa,lang,doc,essay,interview,sum) %>% replace(.,is.na(.),0)
library(ggpubr)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'minimal',tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'default',tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'light', base_size = 10 ,tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'default', base_size = 10 ,tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'default', base_size = 20 ,tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(base_style = 'light' ,tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white',linewidth = 15), padding = unit(c(20, 30), "mm")))
g
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white',linewidth = 50), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'red'), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
ent1 <- entrance %>% filter(schoolindex == 1 & year == 2018) %>% select(3:7) %>% rename()%>% gather()
ent2 <- ent1 %>% filter(value != 0) %>% arrange(desc(value)) %>% mutate(text_y = cumsum(value) - value/2)
ent2$key <- factor(ent2$key,levels = rev(as.character(ent2$key)))
p <- ggplot(ent2,aes(x='',y=value,fill=key)) + geom_bar(width = 1,stat = 'identity', color = 'white')
p <- p + coord_polar(theta = 'y', start = 0 )
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'bottom', legend.title = element_blank()) + guides(fill = guide_legend(reverse = TRUE))
p <- p + geom_text(aes(label = value, y = text_y), nudge_x = .7) + scale_fill_grey(start = 0.8, end = 0.2)
# table plot
p
standard <- read.csv('./rawdatas/entrance_standard.csv')
stan1 <- standard %>% filter(schoolindex == 1 & year == 2018) %>% select(level,leet,gpa,lang,doc,essay,interview,sum) %>% replace(.,is.na(.),0)
library(ggpubr)
g <- ggtexttable(stan1, rows = NULL, theme = ttheme(tbody.style = tbody_style(fill = 'white'), padding = unit(c(20, 30), "mm")))
g
ggarrange(p,g,ncol = 2, nrow = 1)
selected_data_fromschool %>% head(-5)
selected_data_fromschool
selected_data_fromschool %>% tail(-5)
from
head(selected_data_fromschool,6)
a = paste(etc_label$school,etc_label$tot)
a
str(A)
str(a)
a = paste('(',etc_label$school,etc_label$tot,')')
a
a = paste(),etc_label$school,'(',etc_label$tot,')')
a = paste(etc_label$school,'(',etc_label$tot,')')
a
a
print(a)
print(a)
print(a,quote = ',')
sprintf(a)
a = paste(etc_label$school,'(',etc_label$tot,')', collapse = ',')
sprintf(a)
a = paste(etc_label$school,'(',etc_label$tot,')', collapse = ', ')
sprintf(a)
print(a)
a
selected_data_fromschool <- fromschool_data %>% filter(schoolindex == 3) %>% group_by(school) %>%
mutate(tot = sum(y9, y10, y11, y12, y13, y14, y15, y16, y17)) %>% arrange(desc(tot)) %>% distinct(school,tot)
top5 <- selected_data_fromschool %>%  head(5)
etc <- data.frame(school='기타',tot=sum(selected_data_fromschool$tot)-sum(top5$tot))
fromschool <- bind_rows(top5,etc)
fromschool$school <- factor(fromschool$school, levels = rev(as.character(fromschool$school)))
from <- fromschool %>% arrange(school)
text_y <- data.frame(pos = rev(cumsum(fromschool$tot)-fromschool$tot/2))
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
a
.libPaths('e:/data/lib')
library(dplyr)
library(tidyr)
library(ggplot2)
csv <- read.csv('./rawdatas/age.csv')
csv2 <- csv %>% filter(schoolindex == 1) %>% select(ends_with('14'),ends_with('15'),ends_with('16'),ends_with('17')) %>% gather()
csv3 <- csv2 %>% mutate(group = substr(key,1,1),year = substr(key,2,3))
p <- csv3 %>% ggplot(aes(year,value,fill=group)) + geom_bar(stat = 'identity', position = 'dodge', width = 0.5)
p
# csv open
major <- read_csv('./rawdatas/major.csv')
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
age <- read.csv('./rawdatas/age.csv')
age1 <- age %>% filter(schoolindex == 1) %>% select(ends_with('14'),ends_with('15'),ends_with('16'),ends_with('17')) %>% gather()
age2 <- age1 %>% mutate(group = substr(key,1,1),year = substr(key,2,3))
p <- age2 %>% ggplot(aes(year,value,fill=group)) + geom_bar(stat = 'identity', position = 'dodge', width = 0.5)
p
age2
fromschool_data <- read_csv('./rawdatas/fromschool.csv')
school_index <-1
selected_data_fromschool <- fromschool_data %>% filter(schoolindex == 3) %>% group_by(school) %>%
mutate(tot = sum(y9, y10, y11, y12, y13, y14, y15, y16, y17)) %>% arrange(desc(tot)) %>% distinct(school,tot)
top5 <- selected_data_fromschool %>%  head(5)
etc <- data.frame(school='기타',tot=sum(selected_data_fromschool$tot)-sum(top5$tot))
fromschool <- bind_rows(top5,etc)
fromschool$school <- factor(fromschool$school, levels = rev(as.character(fromschool$school)))
from <- fromschool %>% arrange(school)
text_y <- data.frame(pos = rev(cumsum(fromschool$tot)-fromschool$tot/2))
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
p <- p + scale_fill_grey(start = 0.8, end = 0.1) + scale_fill_manual(values = c('#ffcccc','#ff66cc','#ff3399','#ff00ff','#ff00cc','#660033'))
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_manual(values = c('#ffcccc','#ff66cc','#ff3399','#ff00ff','#ff00cc','#660033'))
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_manual(values = c('#ffcccc','#ffccff','#ff3399','#ff00ff','#ff00cc','#660033'))
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_manual(values = c('#ffcccc','#ffccff','#ff3399','#ff00ff','#ff00cc','#660033'))
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_manual(values = c('#ffccff', '#ffcccc', '#ff99cc','#ff00ff','#ff00cc','#660033'))
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_brewer()
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
age <- read.csv('./rawdatas/age.csv')
age1 <- age %>% filter(schoolindex == 1) %>% select(ends_with('14'),ends_with('15'),ends_with('16'),ends_with('17')) %>% gather()
age2 <- age1 %>% mutate(group = substr(key,1,1),year = substr(key,2,3))
age2
p <- age2 %>% ggplot(aes(x=year,y=value,group=group)) + geom_line()
p
p <- age2 %>% ggplot(aes(x=year,y=value,group=group)) + geom_line() + geom_point()
p
p <- age2 %>% ggplot(aes(x=year,y=value,group=group)) + geom_line(aes(linetype=group)) + geom_point()
p
p <- age2 %>% ggplot(aes(x=year,y=value,group=group)) + geom_line(aes(linetype=group)) + geom_point(aes(shape=group))
p
p <- age2 %>% ggplot(aes(x=year,y=value,group=group)) + geom_bar(stat = 'identity')
p
p <- age2 %>% ggplot(aes(x=year,y=value,fill=group)) + geom_bar(stat = 'identity')
p
p <- age2 %>% ggplot(aes(x=year,y=value,fill=group)) + geom_bar(stat = 'identity', width = 0.5)
p
p + coord_cartesian()
p + coord_flip()
p
p + scale_x_discrete(labels=seq(2014,2017,1))
p <- p + scale_x_discrete(labels=seq(2014,2017,1))
p + theme_minimal()
p + theme_minimal() + theme(axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(), axis.text.y = element_blank())
p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(), axis.text.y = element_blank())
p <- p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(), axis.text.y = element_blank())
p + scale_fill_manual(labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FFCCFF','#ffcccc'), labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FF3399','#ffcccc'), labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffcccc'), labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p <- p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(), axis.text.y = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p <- p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하')) + theme(base_size=10)
p <- p + theme_minimal(base_size = 10) + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p <- p + theme_minimal(base_size = 5) + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p <- p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p <- p + scale_x_discrete(labels=seq(2014,2017,1)) + scale_y_discrete(labels=paste(value,%))
p <- age2 %>% ggplot(aes(x=year,y=value,fill=group)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + scale_x_discrete(labels=seq(2014,2017,1)) + scale_y_discrete(labels=paste(value,%))
p <- age2 %>% ggplot(aes(x=year,y=value,fill=group)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + scale_x_discrete(labels=seq(2014,2017,1)) + scale_y_discrete(labels=paste(value,'%'))
p <- p + scale_x_discrete(labels=seq(2014,2017,1)) + scale_y_discrete(labels=paste(y,'%'))
p <- age2 %>% ggplot(aes(x=year,y=value,fill=group)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + scale_x_discrete(labels=seq(2014,2017,1))
p <- p + theme_minimal() + theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), panel.grid.major.x = element_blank(), panel.grid.major.y = element_line(color = 'gray'), panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하'))
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하')) + labs(caption = '단위 : %')
p <- p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'), labels = c('29세 이상','26~28세','25세 이하')) + labs(caption = '단위 : %')
p
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_brewer()
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
major <- csv %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
major
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_line()
p
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
major <- csv %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
major <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
major
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'dodge')
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity')
p
p + coord_trans()
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5, position = 'dodge')
p
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p
p + coord_flip(expand = TRUE)
p + coord_flip()
p <- p + coord_flip()
p + theme_minimal()
str(major)
p + theme_minimal() + scale_x_discrete(limits=c('human','law','nature'))
p + theme_minimal() + scale_x_discrete()
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p + scale_x_discrete(limits=c('human','law','nature'))
p <- p + coord_flip()
p + theme_minimal() + scale_x_discrete(limits=c('human','law','nature'))
p + scale_y_discrete(limits=c('human','law','nature'))
p + scale_x_discrete(limits=c('human','law','nature'))
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p
major
p + theme_minimal() + scale_x_reverse()
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal() + scale_x_reverse()
p + theme_minimal() + scale_y_reverse()
p + theme_minimal() + scale_x_discrete(limits = rev(key))
p + theme_minimal() + scale_x_discrete(limits = rev(major$key))
p
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major$key)))
p
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major$key)))
p
major <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% group_by(key)
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
major <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% group_by(key)
major
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major$key)))
p
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal()
p
p + theme_minimal()
p <- ggplot(major,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major$key)))
major <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
major <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
# csv open
major <- read_csv('./rawdatas/major.csv')
head(major)
major1 <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather()
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major$key)))
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal() + scale_x_discrete(limits = rev(levels(major1$key)))
factor(major1$key)
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip()
p + theme_minimal()
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p + theme_minimal()
major1 <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% arrange(value)
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p + theme_minimal()
major1 <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
p <- ggplot(major1,aes(x=key,y=value,fill=factor(key))) + geom_bar(stat = 'identity', width = 0.5)
p + theme_minimal()
major1 <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p + theme_minimal()
major1$key <- factor(major1$key,levels = rev(major1$key))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p + theme_minimal()
p <- p + coord_flip()
p + theme_minimal()
p + theme_minimal() + theme(axis.title = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.y = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank())
p <- p + coord_flip() + geom_text(aes(label = value))
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank())
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank())
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.background = element_blank())
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.background = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major = element_blank()))
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.x = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank())
p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'))
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'))
p + scale_fill_grey()
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom')
p + scale_fill_grey()
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = 'none')
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p + scale_fill_grey()
p + scale_fill_brewer()
p + scale_fill_brewer(direction = -1)
p <- ggplot(major1,aes(x=key,y=value,fill=key,color='black')) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p
p <- ggplot(major1,aes(x=key,y=value) + geom_bar(stat = 'identity', width = 0.5)
p <- ggplot(major1,aes(x=key,y=value)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p
p + scale_fill_grey()
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
p + scale_fill_manual(values = c('#FF99FF','#FF99ff','#ffccff'))
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
major1 <- major %>% filter(schoolindex == 10) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
major1$key <- factor(major1$key,levels = rev(major1$key))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
major1 <- major %>% filter(schoolindex == 11) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
major1$key <- factor(major1$key,levels = rev(major1$key))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
major1 <- major %>% filter(schoolindex == 14) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
major1$key <- factor(major1$key,levels = rev(major1$key))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
major1 <- major %>% filter(schoolindex == 1) %>%
select(law,human,nature) %>% gather() %>% arrange(desc(value))
major1$key <- factor(major1$key,levels = rev(major1$key))
p <- ggplot(major1,aes(x=key,y=value,fill=key)) + geom_bar(stat = 'identity', width = 0.5)
p <- p + coord_flip() + geom_text(aes(label = value), hjust = -0.2)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text.x = element_blank(), panel.grid.major.y = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.x = element_line(color = 'gray'), legend.position = 'bottom', legend.title = element_blank())
p + scale_fill_manual(values = c('#FF00FF','#FF99ff','#ffccff'))
fromschool_data <- read_csv('./rawdatas/fromschool.csv')
school_index <-1
selected_data_fromschool <- fromschool_data %>% filter(schoolindex == 3) %>% group_by(school) %>%
mutate(tot = sum(y9, y10, y11, y12, y13, y14, y15, y16, y17)) %>% arrange(desc(tot)) %>% distinct(school,tot)
top5 <- selected_data_fromschool %>%  head(5)
etc <- data.frame(school='기타',tot=sum(selected_data_fromschool$tot)-sum(top5$tot))
fromschool <- bind_rows(top5,etc)
fromschool$school <- factor(fromschool$school, levels = rev(as.character(fromschool$school)))
from <- fromschool %>% arrange(school)
text_y <- data.frame(pos = rev(cumsum(fromschool$tot)-fromschool$tot/2))
p <- ggplot(from,aes(x='',y=tot,fill=school)) + geom_bar(width = 1, size =1, color = 'white', stat = 'identity')
p <- p+coord_polar('y', start = 0)
p <- p + theme_minimal() + theme(axis.title = element_blank(), axis.text = element_blank(), panel.grid = element_blank(), legend.position = 'none')
# p <- p + scale_fill_grey(start = 0.8, end = 0.1)
p <- p + scale_fill_brewer()
p + geom_text(aes(label=paste(school,tot), y = text_y), nudge_x = 0.7 )
etc_label <- selected_data_fromschool %>% tail(-5)
a = paste(etc_label$school,'(',etc_label$tot,')', collapse = ', ')
print(a)
