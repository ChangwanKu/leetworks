axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=15,family="KoPubBatang Light"))+
coord_fixed(ratio=dim(sexdata1)[2]/((max(sexdata1$value)+10)*4),ylim = c(0, max(sexdata1$value)+10))
sexplot
sexplot <- ggplot(sexdata1,aes(x=year, y=value, fill = group)) + geom_bar(stat='identity', position = 'dodge', width = 0.5)+
geom_text(size=10,aes(x=year, y=value, label = value),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('남','여')) +
scale_x_discrete(labels=seq(2014,2017,1))+
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=dim(sexdata1)[2]/((max(sexdata1$value)+10)*4),ylim = c(0, max(sexdata1$value)+10))
sexplot
ratio=dim(sexdata1)[2]/((max(sexdata1$value)+10)*4)
ratio
sexplot <- ggplot(sexdata1,aes(x=year, y=value, fill = group)) + geom_bar(stat='identity', position = 'dodge', width = 0.5)+
geom_text(size=10,aes(x=year, y=value, label = value),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('남','여')) +
scale_x_discrete(labels=seq(2014,2017,1))+
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=0.025,ylim = c(0, max(sexdata1$value)+10))
sexplot
max(sexdata1$value)+10
max(sexdata1$value)
1.25*5.5
myschool <- read.csv('./rawdatas/myschool.csv') %>%
filter(癤퓋choolindex == the_number) %>% select(m14, o14, m15, o15, m16, o16, m17, o17)
myschool1 <- gather(myschool) %>%
mutate(group=substr(key,1,1),year=substr(key,2,3))
myschool1
ratio=dim(sexdata1)[2]
ratio
myschool <- read.csv('./rawdatas/myschool.csv') %>%
filter(癤퓋choolindex == the_number) %>% select(m14, o14, m15, o15, m16, o16, m17, o17)
myschool1 <- gather(myschool) %>%
mutate(group=substr(key,1,1),year=substr(key,2,3))
myschoolbarplot <- ggplot(myschool1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5) +
geom_text(size=geom_font,aes(x=year, y=value, label = paste0(value)),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('자','타'))+
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))
legend_font <- 30
geom_font <- 5
x_axis_font <- 15
myschool <- read.csv('./rawdatas/myschool.csv') %>%
filter(癤퓋choolindex == the_number) %>% select(m14, o14, m15, o15, m16, o16, m17, o17)
myschool1 <- gather(myschool) %>%
mutate(group=substr(key,1,1),year=substr(key,2,3))
myschoolbarplot <- ggplot(myschool1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5) +
geom_text(size=geom_font,aes(x=year, y=value, label = paste0(value)),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('자','타'))+
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))
myschoolbarplot
myschool1
myschoolbarplot <- ggplot(myschool1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5) +
geom_text(size=geom_font,aes(x=year, y=value, label = paste0(value)),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('자','타'))+
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light")) +
coord_fixed(4/((max(myschool1$value)*7)),ylim = c(0, max(myschool1$value)*1.25))
myschoolbarplot
legend_font <- 15
geom_font <- 5
x_axis_font <- 15
myschool <- read.csv('./rawdatas/myschool.csv') %>%
filter(癤퓋choolindex == the_number) %>% select(m14, o14, m15, o15, m16, o16, m17, o17)
myschool1 <- gather(myschool) %>%
mutate(group=substr(key,1,1),year=substr(key,2,3))
myschoolbarplot <- ggplot(myschool1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5) +
geom_text(size=geom_font,aes(x=year, y=value, label = paste0(value)),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('자','타'))+
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light")) +
coord_fixed(4/((max(myschool1$value)*7)),ylim = c(0, max(myschool1$value)*1.25))
myschoolbarplot
foreign <- read.csv('./rawdatas/foreign.csv')  %>%
rename(schoolindex = 癤퓋choolindex) %>%
filter(schoolindex == the_number) %>%
select(f14, f15, f16, f17) %>% gather()
#foreign
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))
foreign_plot
4/((max(myschool1$value)*7))
max(myschool1$value)*1.25)
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=0.013),ylim = c(0, 5)
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=0.013),ylim = c(0, 5))
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=0.1),ylim = c(0, 5))
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="KoPubBatang Light") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ratio=0.1),ylim = c(0, 5))
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF',family="KoPubBatang Light") +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))
foreign_plot
source('~/.active-rstudio-document', encoding = 'UTF-8', echo=TRUE)
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ylim = c(0, 5))
foreign_plot
foreign
foregin$value
max(foreign$value)*1.25
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ylim = c(0, max(foreign$value)*1.25))
foregin_plot
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_line(color='gray'), axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ylim = c(0, max(foreign$value)*1.25))
foreign_plot
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=30,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=30,family="KoPubBatang Light"))+
coord_fixed(ylim = c(0, max(foreign$value)*1.25))
foreign_plot
foreign_plot <- ggplot(foreign,aes(key,value)) + geom_bar(stat='identity',width = 0.5, fill='#FF00FF') +
geom_text(size=geom_font,aes(key,value,label = paste0(value)),vjust=-0.5, family="KoPubBatang Light") +
scale_x_discrete(labels=seq(2014,2017,1)) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))+
coord_fixed(ylim = c(0, max(foreign$value)*1.25))
foreign_plot
for (the_number in 1:10) {
myschool <- read.csv('./rawdatas/myschool.csv') %>%
filter(癤퓋choolindex == the_number) %>% select(m14, o14, m15, o15, m16, o16, m17, o17)
myschool1 <- gather(myschool) %>%
mutate(group=substr(key,1,1),year=substr(key,2,3))
sexdata <- read.csv('./rawdatas/sex.csv') %>%
rename(schoolindex = 癤퓋choolindex) %>%
filter(schoolindex == the_number) %>%
select(m14, w14, m15, w15, m16, w16, m17, w17)
sexdata1 <- gather(sexdata) %>% mutate(group=substr(key,1,1),year=substr(key,2,3))
print(4/((max(myschool1$value)*7)))
print(4/((max(sexdata1$value)*7)))
}
sexplot <- ggplot(sexdata1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5)+
geom_text(size=geom_font,aes(x=year, y=value, label = value),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('남','여')) +
scale_x_discrete(labels=seq(2014,2017,1))+
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_blank(),
axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))+
coord_fixed(ratio=4/((max(sexdata1$value)*7)),ylim = c(0, max(sexdata1$value)*1.25))
sexplot
sexplot <- ggplot(sexdata1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5)+
geom_text(size=geom_font,aes(x=year, y=value, label = value),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('남','여')) +
scale_x_discrete(labels=seq(2014,2017,1))+
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_blank(),
axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))+
coord_fixed(ratio=3.7/((max(sexdata1$value)*7)),ylim = c(0, max(sexdata1$value)*1.25))
sexplot
sexplot <- ggplot(sexdata1,aes(x=year, y=value, fill = group)) +
geom_bar(stat='identity', position = 'dodge', width = 0.5)+
geom_text(size=geom_font,aes(x=year, y=value, label = value),vjust=-0.5, position = position_dodge(0.5),
family="KoPubBatang Light") +
scale_fill_manual(values = c('#FF00FF','#FFCCFF'), labels = c('남','여')) +
scale_x_discrete(labels=seq(2014,2017,1))+
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(size=x_axis_font,family="KoPubBatang Light"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
plot.margin = margin(t = 0, r = 0, b = 5, l = 5, unit = "pt"),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color ='gray'),
panel.grid.minor.y = element_blank(),
axis.ticks = element_blank(),
legend.title=element_blank(),legend.position="bottom",
legend.direction="horizontal",legend.text = element_text(size=legend_font,family="KoPubBatang Light"))+
coord_fixed(ratio=3.5/((max(sexdata1$value)*7)),ylim = c(0, max(sexdata1$value)*1.25))
sexplot
entrance <- read.csv('./rawdatas/모집인원(16,17,18,19).csv') %>%
filter(schoolindex == the_number & year == 2018) %>% select(3:7) %>% rename()%>% gather() %>%
filter(value != 0) %>% arrange(desc(value)) %>% mutate(text_y = cumsum(value) - value/2)
entrance$key <- factor(entrance$key,levels = rev(as.character(entrance$key)))
mojip_plot <- ggplot(entrance,aes(x='',y=value,fill=key)) + geom_bar(width = 1,stat = 'identity', color = 'white') +
coord_polar(theta = 'y', start = 0 ) +
theme_minimal() +
theme(axis.title = element_blank(), axis.text = element_blank(),
panel.grid = element_blank(), legend.position = 'bottom',
plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"),
legend.title = element_blank(),legend.text = element_text(size=12,family="KoPubBatang Light"),
legend.margin=margin(0,0,0,0),legend.spacing.x=unit(-15,"cm")) +
guides(fill = guide_legend(reverse = TRUE))+
geom_text(size=6,aes(label = value, y = text_y), nudge_x = 0.7, family="KoPubBatang Light") +
scale_fill_manual(values = c("#FF7FFF", "#FF4CFF", "#FF33FF", "#FF00FF"))
# p + scale_fill_manual(values = c('#FFCCFF','#FF3399','#FF00FF','#FF00CC'))
standard <- read.csv('./rawdatas/entrance_standard.csv') %>%
filter(schoolindex == the_number & year == 2018) %>%
select(level,leet,gpa,lang,doc,essay,interview,sum) %>%
replace(.,is.na(.),0)
standard_table <- ggtexttable(standard, rows = NULL, theme = ttheme(base_size=5 ,tbody.style = tbody_style(fill = 'white'), ))
#
# # pie 랑 table 합체
#
# print(ggarrange(mojip_plot,standard_table,ncol = 2, nrow = 1))
#print(grid.arrange(mojip_plot, standard_table, ncol = 2))
g<-tableGrob(standard, rows = NULL, theme = ttheme_minimal(padding = unit(c(5,20), 'mm')))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 1, b = 1, l = 1, r = ncol(g))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 1, b = 2, l = 1, r = ncol(g))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 2, b = 3, l = 1, r = ncol(g))
standard <- read.csv('./rawdatas/entrance_standard.csv') %>%
filter(schoolindex == the_number & year == 2018) %>%
select(level,leet,gpa,lang,doc,essay,interview,sum) %>%
replace(.,is.na(.),0)
#
# # pie 랑 table 합체
#
# print(ggarrange(mojip_plot,standard_table,ncol = 2, nrow = 1))
#print(grid.arrange(mojip_plot, standard_table, ncol = 2))
g<-tableGrob(standard, rows = NULL, theme = ttheme_minimal(padding = unit(c(5,20), 'mm')))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 1, b = 1, l = 1, r = ncol(g))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 1, b = 2, l = 1, r = ncol(g))
g<-gtable_add_grob(g, grobs = segmentsGrob(x0 = unit(0,"npc"),
y0 = unit(0,"npc"),
x1 = unit(1,"npc"),
y1 = unit(0,"npc"),
gp = gpar(lwd = 2.0, col = "#FF7FFF")),
t = 2, b = 3, l = 1, r = ncol(g))
ggarrange(g)
mojip_plot
warnings()
warnings()
writeLines()
warnings()
warnings()
